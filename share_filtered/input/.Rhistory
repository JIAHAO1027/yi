}
newnewnewtonmethod<-function(x1, f, df, g){
x<-x1
while(abs(f(x))>g){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=fx ,col="blue",size=3)
}
}
newnewnewtonmethod(-2, f, df, 0.00001)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2, , length = 100)
yseq <- xseq^3 -*xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<--2
while(abs(fx) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=fx ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2, , length = 100)
yseq <- xseq^3 -*xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<--2
while(abs(fx) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -*xseq +1
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<--2
while(abs(fx) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<--2
while(abs(fx) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x, y=f(x) ,col="blue",size=3)
}
x<--2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x, y= f(x) ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<--2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/df(x)
df=data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x, y= f(x) ,col="blue",size=3)
}
x<--2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/df(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x, y= f(x) ,col="blue",size=3)
}
x<--2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/df(x)
dff<- data.frame(a=x,b=f(x))
print(dff)
p <- p + geom_point(x=x, y= f(x) ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
df<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<- -2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/df(x)
dff<- data.frame(a=x,b=f(x))
print(dff)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<- -2
while(abs(f(x)) > 0.00001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x, y=f(x) ,col="blue",size=3)
}
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
newton<-function(x){
while(abs(f(x)) > 0.00001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x= x, y=f(x) ,col="blue",size=3)
}
}
newton(-2)
p + geom_hline(yintercept = 0)
library(DataComputing)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
newton<-function(x){
while(abs(f(x)) > 0.00001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x= x, y=f(x) ,col="blue",size=3)
}
}
newton(-2)
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
newton<-function(x){
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x= x, y=f(x) ,col="blue",size=3)
}
}
newton(-2)
p + geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
newton<-function(x){
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
}
}
newton(-2)
p + geom_point(x= x, y=f(x) ,col="blue",size=3)+geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
newton<-function(x){
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
}
newton(-2)
p +geom_hline(yintercept = 0)
p
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
file.choose9
file.choose()
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
```
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
p
p
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
p
f<-function(x){
return(x^3-x+1)
}
dff<-function(x){
return(3*x^2-1)
}
xseq <- seq(-2,2, length = 100)
yseq <- xseq^3 -xseq +1
df <- data.frame(xseq,yseq)
p <- df %>% ggplot(aes(x=xseq, y=yseq)) + geom_line(stat="identity", col="red")
x<- -2
while(abs(f(x)) > 0.000001){
x <- x - f(x)/dff(x)
df<- data.frame(a=x,b=f(x))
print(df)
p <- p + geom_point(x=x,y=f(x) ,col="blue",size=3)
}
p +geom_hline(yintercept = 0)
```
count<-c()
b<-function(n, plotit=TRUE){
x<-runif(n, min=-1, max=1)
y<-runif(n, min=-1, max=1)
for(i in 1:n){
if((x[i])^2 + (y[i])^2<=1){
count<-append(count,1)
}else{
count<-append(count,0)
}
if(plotit==TRUE){
df<-data.frame(x,y,in_or_out)
print(ggplot(df, aes(x,y))+geom_point(aes(col=in_or_out)))
}
return(4*sum(count)/n)
}
b(200, plotit=TRUE)
```
count<-c()
b<-function(n, plotit=TRUE) {
x<-runif(n, min=-1, max=1)
y<-runif(n, min=-1, max=1)
for(i in 1:n){
if((x[i])^2 + (y[i])^2<=1){
count<-append(count,1)
}else{
count<-append(count,0)
}
}
if(plotit==TRUE){
df<-data.frame(x,y,in_or_out)
print(ggplot(df, aes(x,y))+geom_point(aes(col=in_or_out)))
}
return(4*sum(count)/n)
}
b(200, plotit=TRUE)
x<-runif(100, min=-1, max=1)
y<-runif(100,min=-1, max=1)
count<-c()
func<- function(x,y){
for(i in 1:100){
if((x[i])^2 + (y[i])^2<=1){
count<-append(count,1)
}else{
count<-append(count,0)
}
}
return(count)
}
in_or_out<- func(x,y)
proportion<-sum(func(x,y)/100)
proportion
df<-data.frame(x,y,in_or_out)
ggplot(df, aes(x,y))+geom_point(aes(col=in_or_out))
count<-c()
b<-function(n, plotit=TRUE) {
x<-runif(n, min=-1, max=1)
y<-runif(n, min=-1, max=1)
for(i in 1:n){
if((x[i])^2 + (y[i])^2<=1){
count<-append(count,1)
}else{
count<-append(count,0)
}
}
if(plotit==TRUE){
df<-data.frame(x,y,in_or_out)
print(ggplot(df, aes(x,y))+geom_point(aes(col=in_or_out)))
}
return(4*sum(count)/n)
}
b(200, plotit=TRUE)
count<-c()
b<-function(n, plotit=TRUE) {
x<-runif(n, min=-1, max=1)
y<-runif(n, min=-1, max=1)
View(x)
count<-c()
b<-function(n, plotit=TRUE) {
x<-runif(n, min=-1, max=1)
y<-runif(n, min=-1, max=1)
for(i in 1:n){
if((x[i])^2 + (y[i])^2<=1){
count<-append(count,1)
}else{
count<-c()
b<-function(n, plotit=TRUE) {
x1<-runif(n, min=-1, max=1)
y1<-runif(n, min=-1, max=1)
for(i in 1:n){
if((x1[i])^2 + (y1[i])^2<=1){
count<-append(count,1)
}else{
count<-append(count,0)
}
}
if(plotit==TRUE){
df<-data.frame(x1,y1,in_or_out)
print(ggplot(df, aes(x1,y1))+geom_point(aes(col=in_or_out)))
}
return(4*sum(count)/n)
}
b(200, plotit=TRUE)
```
library(dplyr)
library(stringi)
library(DataComputing)
library(dplyr)
setwd( "/Users/suyanglu/Dropbox/urap_programming/suyang/share_filtered/input")
filename="transec_700d_cleaned_20160215.csv"
#read the excel file
df_input = read.csv(filename,head=TRUE)
df_input<-df_input%>%select(item_id, amount, color_category_ind_18_55, bundle_index)
#group the cells
grouped_sales <- df_input %>% group_by(item_id)%>%summarize(item_sales=sum(amount))
grouped_bundle <- df_input%>% group_by(item_id, bundle_index)%>%summarize(bundle_sales=sum(amount))
grouped_f_sales <- df_input%>%group_by(item_id, color_category_ind_18_55)%>%summarize(filterted_item_sales=sum(amount))
#grouped_f_sales <- grouped_f_sales%>%select(item_id,filterted_item_sales )
grouped_f_bundle = df_input %>%group_by(item_id, bundle_index, color_category_ind_18_55)%>%summarize(filtered_bundle_sales=sum(amount))
#grouped_f_bundle =grouped_f_bundle%>%select(item_id, bundle_index,filtered_bundle_sales)
#merge
df1 = data.frame(grouped_sales)
df2 = data.frame(grouped_bundle)
s1 <- right_join(df1,df2, by="item_id")
df3 <- data.frame(grouped_f_sales['item_id','filterted_item_sales'])
df4 = data.frame(grouped_f_bundle['item_id', 'bundle_index','filtered_bundle_sales'])
View(df3)
View(grouped_f_sales)
View(s1)
df3 <- data.frame(grouped_f_sales%>%select(item_id,filterted_item_sales ))
View(df3)
df4 <- data.frame(grouped_f_bundle%>%select(item_id, bundle_index,filtered_bundle_sales))
s1 = left_join(s1, df3, by="item_id")
s1 = left_join(s1, df4, by=c("item_id", "bundle_index"))
#share function
count<-function(x){
return(x['bundle_sales'] / x['item_id_sale'])
}
f_count<-function(x){
return(x['filtered_bundle_sales'] / x['filterted_item_sales'])
View(s1)
s1['share'] <- count(s1)
s1['filtered_item_share'] <- f_count(s1)
s1
#output the file
